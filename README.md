# What is this?
This is a dead-simple headless cms. 

# Why?
I feel like most headless cms are geared towards marketing teams.
I just want something simple that gets out of my way to serve data for some websites.
I feel like this is it.

# Using with Github Webhooks
If you dont want to rebuild centra everytime, there's also the option to use github webhooks to auto populate.
## Steps
### 1. Spin up Centra and get the Webhook hooking.
You should start the centra docker container using any tool you like and make it reachable from the outside. (Webhook uses `/webhook`).
Once that is settled, you can create the webhook in GitHub.
For that:
1. Go to your repositories settings
2. Click on Webhook
3. Click on "Add webhook"
4. In the payload url, you should enter the url under which Centra is available. For example `my.centra.lmfao/webhook`.
4. Set the content type to `application/json`. This is really importante!
5. If you have configured an SSL certificate for the domain, you can leave SSL Verification on. If not, not.
6. The events can be left on `Just the push event`
7. Hit "Add Webhook"
### Deploy Keys
Centra uses Deploy Keys to update (or clone) the repo once the webhook route gets hit.
Deploy keys are generated by Centra once the server start for the first time. 
> [!IMPORTANT]
> Centra only supports `ed25519` keys and I can't be bothered to implement others.
#### Creating Own Keys
I recommend to create the keys on your own and mount them into the container (`/keys` is the default path).
This is the best method since those keys are persistent and Centra can directly use these keys for the initial clone.
#### Letting Centra Create The Keys
Centra will, if no keys are under `/keys`, create a new keypair that it wants to use for cloning/pulling. 
It will always output the public key to stdout when it's started so you can easily add it as an deploy key.
Please make sure, that you mount a volume to the containers key path.
If you don't, the keys are not persistent and you'll have to re-add them in Github after every time the container is deleted.

# Using with Dockerfile / Rebuilding
To use centra, you first have to create a folder (/git repo)
This repository will contain all your content files aswell as a dockerfile.

## Setup
This guide takes the following structure for granted
```
- Dockerfile
- content/
-- pages
--- home.yaml
-- sections
--- about.yaml
```

### Dockerfile
To get your CMS running, you have to create the following Dockerfile
```Dockerfile
FROM ghcr.io/cheetahbyte/centra:latest
COPY content/ /content
ENV CONTENT_ROOT=/content
```

### Other files
#### `content/pages/home.yaml`
This file contains the main "page". 
```yaml
updated_at: 2025-11-17

sections:
  - $ref: "sections/about/why"
```

#### `content/sections/about.yaml`
```yaml
type: "text-section"
heading: "About US"
body: |
  Bla
  Bla
  Bla
```

> ðŸŽ‰ Congrats!
> Build & deploy your Dockerfile, and your CMS is live.

## Request your first data
```js
const res = await fetch("<domain>/api/pages/home")
const data = await res.json()
```
Done.
# Environment Variables
There a few env vars that can be configured

| Variable | Description | Default |
|----------|-------------|----------|
| `PORT` | sets the port on which the webserver starts | `3000` |
| `CENTRA_API_KEY` | provided a string here will set the key used to protect the content api  | NONE |
| `CONTENT_ROOT` | sets the directory where the server will look for content | `/content` |
| `KEYS_DIR` | sets the directory where the server will place the ssh keys | `/keys` |
| `GITHUB_REPO_URL` | sets the GitHub repo from which the content is served | _none_ |
| `EXPERIMENTAL_CACHING` | enables the new caching method â€” all files are cached on start and served from memory | `false` |
| `CORS_ALLOWED_ORIGINS` | list of allowed origins | `*` |
| `CORS_ALLOWED_METHODS` | list of allowed methods | `["GET","HEAD","OPTIONS"]` |
| `CORS_ALLOWED_HEADERS` | list of allowed request headers | `*` |
| `CORS_EXPOSED_HEADERS` | list of headers exposed to the browser | `["Cache-Control","Content-Language","Content-Length","Content-Type","Expires","Last-Modified"]` |
| `CORS_ALLOW_CREDENTIALS` | whether credentials (cookies/auth headers) are allowed | `false` |
| `CORS_MAX_AGE` | max age of preflight cache (in seconds) | `360` |
| `SSH_PRIVATE_KEY` | ssh private key used for communication with git | NONE |
| `SSH_PUBLIC_KEY` | ssh public key used for communication with git | NONE |
| `LOG_LEVEL` | sets the log level | `INFO` |
| `LOG_STRUC` | turns off pretty printing of the logs and logs in plain json  | `false` |
